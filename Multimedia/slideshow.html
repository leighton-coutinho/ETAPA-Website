<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>	
		<title>TRAM: Transportation Research at McGill</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">		
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
		<link rel="stylesheet" type="text/css" media="screen,projection" href="/reset.css" />		
        <link rel="stylesheet" type="text/css" media="screen and (min-device-width:1025px)" href="/style-large-screen.css">
        <link rel="stylesheet" type="text/css" media="screen and (max-device-width:1024px)" href="/style-mobile.css">
		<link rel="shortcut icon" href="/images/tramIcon.ico">
		
		<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>	
		
	
		<script>
			var globalSlideShowState = "play2";			
			var globalTimer = -1;	
            
            // for mobile
            var imageNameList = [];
            var currentImageIndex = 0;
            var fullScreen = false;
            var imageLoop = false;

            function isMobile()
            {   var agent = navigator.userAgent.toLowerCase();	
                return agent.indexOf("iphone") != -1 || agent.indexOf("ipad") != -1 || agent.indexOf("android") != -1;
            }
                           
			
			$( document ).ready(function() {
                if (isMobile())
                {   //alert('a');
                    document.getElementById("fullScreenSlideShowWrapper").addEventListener("click", function (e) {                        
                        //alert('b');
                        goFullScreen();                        
                        //alert('c');
                        startSlideShow(0);
                    }, false);                                       
                }
                loadImages();
				startSlideShow(3000);
			});
			
			
			function loadImages()
			{	appendImage("/images/team/2014/P1130034.jpg");
				appendImage("/images/team/2014/P1140051.jpg");
				appendImage("/images/team/2014/P1140064.jpg");					
				appendImage("/images/team/2014/P1140068.jpg");
				appendImage("/images/team/2014/P1140075.jpg");
				/*
                appendImage("/images/team/2014/P1140078.jpg");
				appendImage("/images/team/2014/P1140083.jpg");
				appendImage("/images/team/2014/P1140091.jpg");
				appendImage("/images/team/2014/P1150149.jpg");
				appendImage("/images/team/2014/P1160249.jpg");
				appendImage("/images/team/2014/IMG_0709.jpg");
				appendImage("/images/team/2014/IMG_0878.jpg");
				
				appendImage("/images/team/2013/DSC_6585.jpg");					
				appendImage("/images/team/2013/Ehab_poster.jpg");
				appendImage("/images/team/2013/IMG_1360.jpg");					
				appendImage("/images/team/2013/Kevin_devon_Ahmed_Dea_Mike2.jpg");
				appendImage("/images/team/2013/Kevin_devon_poster (2).jpg");
				appendImage("/images/team/2013/Mike_dea_good one.jpg");
				appendImage("/images/team/2013/Nicole_poster.jpg");
				appendImage("/images/team/2013/tram2013_tree_cropped.jpg");					
				appendImage("/images/team/2013/Yousaf_poster.jpg");
				
				appendImage("/images/team/2012/group2012.jpg");
				appendImage("/images/team/2012/TRAM_group2012_2.jpg");
				
				appendImage("/images/team/2011/julie_Jacob_TRB2011.jpg");
				appendImage("/images/team/2011/Julien_TRB2011.jpg");
				appendImage("/images/team/2011/Nithya_TRB2011.jpg");
				appendImage("/images/team/2011/TRAM_group_TRB.jpg");
				
				appendImage("/images/team/2010/Convocation_2010.jpg");
				appendImage("/images/team/2010/group_members_summer_2010.jpg");
				appendImage("/images/team/2010/jacob_TRB_2010.jpg");
				appendImage("/images/team/2010/Julien_TRB_2010.jpg");
				appendImage("/images/team/2010/Matt_TRB2010.jpg");
				appendImage("/images/team/2010/TRAM_team_winter2010_2.jpg");
				appendImage("/images/team/2010/TRAM_W2010.jpg");
				appendImage("/images/team/2010/TRAM_Winter2010.jpg");					
				
				appendImage("/images/team/2009/Group_June_09.jpg");
				appendImage("/images/team/2009/Paul_TRB.jpg");
				
				appendImage("/images/team/2008/Group_June_08.jpg");*/
			}
            
            function startSlideShow(speed)
			{	
                if (isMobile())
                {   
                    if (fullScreen)
                    {   
                        var images = document.getElementsByClassName('fullScreenSlideShowImage');
                        if (images.length > 0)  // already been here
                            return;
                            
                        currentImageIndex = 0;
                        for (var i = 0; i < 2; i++)
                        {   //alert(i);
                            loadImage(imageNameList[i], i, 2-i);
                        }                         
                        var currentImage = document.getElementById('fullScreenSlideShowImage' + currentImageIndex); 
                        currentImage.style.left = "0vw";
                        currentImage.style.right = "0vw";                        
                        
                        //alert('a');
                        

                        $(window).on("orientationchange",function(event)
                        {   
                            //alert('orientationchange - start');
                            
                            document.getElementById('fullScreenSlideShow').style.display = "none";
                            var images = document.getElementsByClassName('fullScreenSlideShowImage'); 
                            for (var i = 0; i < images.length; i++)                            
                                images[i].style.display = "none";
                            
                            setTimeout(function()
                            {   var images = document.getElementsByClassName('fullScreenSlideShowImage'); 
                                for (var i = 0; i < images.length; i++)                            
                                {   calculateDimensions(images[i]);                                                        
                                    images[i].offsetHeight;
                                }
                                document.getElementById('fullScreenSlideShow').style.display = "block";                                
                                for (var i = 0; i < images.length; i++)                            
                                    images[i].style.display = "block";
                                    
                            }, 200);
                            
                            
                            
                            
                            
                            //alert('orientationchange - done');
                            //document.getElementById('fullScreenSlideShow').style.display = "block";
                        });                        
                        
                        $("#fullScreenSlideShow").on("swipeleft",function()
                        {                           
                            var currentImage = document.getElementById('fullScreenSlideShowImage' + currentImageIndex); 
                            currentImage.style.left = '-100vw';
                            currentImage.style.right = "100vw";
                            
                            var nextImage = document.getElementById('fullScreenSlideShowImage' + ((currentImageIndex+1)%imageNameList.length));
                            nextImage.style.left = '0vw';
                            nextImage.style.right = "0vw";
                                                        
                            if (imageLoop == false && currentImageIndex+2 < imageNameList.length)
                                loadImage(imageNameList[currentImageIndex+2], currentImageIndex+2, 1);
                            else
                            {   var nextNextImage = document.getElementById('fullScreenSlideShowImage' + ((currentImageIndex+2)%imageNameList.length) );
                                calculateDimensions(nextNextImage, 'nextnext');
                                nextNextImage.style.left = "100vw";
                                nextNextImage.style.right = "-100vw";
                            }
                            
                            currentImageIndex++;
                            if (currentImageIndex == imageNameList.length)
                            {   imageLoop = true;
                                currentImageIndex = currentImageIndex % imageNameList.length;
                            }
                        });
                        
                        $("#fullScreenSlideShow").on("swiperight",function()
                        {
                            var images = document.getElementsByClassName('fullScreenSlideShowImage');
                            if (currentImageIndex == 0 && images.length < imageNameList.length)                                 
                                return;  // not all images have been loaded; can't cycle around to end
                            
                            var currentImage = document.getElementById('fullScreenSlideShowImage' + currentImageIndex); 
                            currentImage.style.left = '100vw';
                            currentImage.style.right = "-100vw";
                            
                            var prevImageIndex = currentImageIndex - 1;
                            if (prevImageIndex == -1)
                                prevImageIndex = imageNameList.length - 1;
                                
                            var prevImage = document.getElementById('fullScreenSlideShowImage' + (prevImageIndex));
                            prevImage.style.left = '0vw';
                            prevImage.style.right = "0vw";
                            
                            currentImageIndex = prevImageIndex;
                            
                            // prep the next image
                            if (prevImageIndex == 0 && images.length < imageNameList.length)                                 
                                return;  // not all images have been loaded; can't cycle around to end (on next swipe right)
                                
                            var prevPrevImageIndex = prevImageIndex - 1;
                            if (prevPrevImageIndex == -1)
                                prevPrevImageIndex = imageNameList.length - 1;
                                
                            var prevPrevImage = document.getElementById('fullScreenSlideShowImage' + (prevPrevImageIndex));
                            prevPrevImage.style.left = '-100vw';
                            prevPrevImage.style.right = "100vw";     
                                                        
                        });
                    }
                }
                else
                {
                    $(function()
                    {	$('.slideshow > :gt(0)').hide();
                        globalTimer = setInterval(function()					
                        {
                            $('.slideshow > :first-child').fadeOut().next().fadeIn().end().appendTo('.slideshow'); 
                        }, speed);												
                    });					
                }
			}	
			
			function appendImage(imageName)
			{	if (isMobile())
                {   imageNameList.push(imageName);
                }
                else
                {
                    var node = document.createElement('img');
                    node.setAttribute('class', 'fullScreenSlideShowImage');
                    node.setAttribute('src', imageName);				
                    document.getElementById('fullScreenSlideShow').appendChild(node);		
                }
			}
            
            function loadImage(imageName, id, zIndex)
            {   //alert('loading');
                var node = document.createElement('img');
                node.setAttribute('id', 'fullScreenSlideShowImage' + id);
                node.setAttribute('class', 'fullScreenSlideShowImage');                
                node.setAttribute('style', 'display: none; z-index:' + zIndex + '; left: 100vw; right: -100vw;');				                
                node.setAttribute('src', imageName);
                node.addEventListener("load", function(e) 
                {   calculateDimensions(node, 'initial');
                    node.style.display = "block";
                }, false);
                document.getElementById('fullScreenSlideShow').appendChild(node);                                             
            }
            
            function calculateDimensions(image, tag)
            {                   
                var screenRatio = window.outerWidth / window.outerHeight;               
                var imageRatio = image.width / image.height;
                
                if (imageRatio < screenRatio)
                {   image.style.height = '100vh';
                    image.style.width = (100*imageRatio) + 'vh';
                    image.style.top = '0vh';
                }
                else
                {   image.style.width = '100vw';
                    image.style.height = (100/imageRatio) + 'vw';
                    image.style.top = 'calc( (100vh - (100vw / ' + imageRatio + ')) / 2)';
                }                                            
            }
            
            function goFullScreen() 
            {
                if (!document.fullscreenElement &&    
                    !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement ) 
                {   if (document.documentElement.requestFullscreen) 
                    {    document.documentElement.requestFullscreen();
                    } 
                    else if (document.documentElement.msRequestFullscreen) 
                    {    document.documentElement.msRequestFullscreen();
                    } 
                    else if (document.documentElement.mozRequestFullScreen) 
                    {    document.documentElement.mozRequestFullScreen();
                    } 
                    else if (document.documentElement.webkitRequestFullscreen) 
                    {    document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
                    }
                    fullScreen = true;
                }                 
            }
			
		</script>		

		<!-- Google Analytics code -->
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-54231741-1', 'auto');
		  ga('send', 'pageview');

		</script>
		
	</head>
	<body>		
		<div id="fullScreenSlideShowWrapper">
            <div id="fullScreenSlideShow"></div>
            <!--
            <div id="numImages">0</div><div id="currentImage">-1</div>
            <div id="image0"></div>
            <div id="image1"></div>
            <div id="image2"></div>
            <div id="image3"></div>
            <div id="image4"></div>-->
        </div>
				
	</body>
</html>

